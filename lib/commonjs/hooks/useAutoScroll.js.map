{"version":3,"names":["_reactNativeReanimated","require","_constants","_propsContext","_animatedValueContext","_refContext","useAutoScroll","_useRefs","useRefs","flatlistRef","_useProps","useProps","_useProps$autoscrollT","autoscrollThreshold","DEFAULT_PROPS","_useProps$autoscrollS","autoscrollSpeed","_useAnimatedValues","useAnimatedValues","scrollOffset","scrollViewSize","containerSize","activeCellSize","hoverOffset","activeIndexAnim","hoverScreenOffset","useDerivedValue","_f","value","_closure","asString","__workletHash","__location","isScrolledUp","SCROLL_POSITION_TOLERANCE","isScrolledDown","distToTopEdge","Math","max","distToBottomEdge","hoverPlusActiveCell","isAtTopEdge","isAtBottomEdge","scrollTarget","useSharedValue","dragIsActive","useAnimatedReaction","cur","prev","shouldAutoScroll","scrollTargetDiff","abs","hasScrolledToTarget","isAtEdge","topDisabled","bottomDisabled","isEdgeDisabled","cellIsActive","scrollToInternal","offset","_flatlistRef$current","current","scrollToOffset","animated","distFromEdge","speedPct","targetOffset","min","runOnJS"],"sources":["useAutoScroll.tsx"],"sourcesContent":["import {\n  runOnJS,\n  useAnimatedReaction,\n  useDerivedValue,\n  useSharedValue,\n} from \"react-native-reanimated\";\nimport { DEFAULT_PROPS, SCROLL_POSITION_TOLERANCE } from \"../constants\";\nimport { useProps } from \"../context/propsContext\";\nimport { useAnimatedValues } from \"../context/animatedValueContext\";\nimport { useRefs } from \"../context/refContext\";\n\nexport function useAutoScroll() {\n  const { flatlistRef } = useRefs();\n\n  const {\n    autoscrollThreshold = DEFAULT_PROPS.autoscrollThreshold,\n    autoscrollSpeed = DEFAULT_PROPS.autoscrollSpeed,\n  } = useProps();\n\n  const {\n    scrollOffset,\n    scrollViewSize,\n    containerSize,\n    activeCellSize,\n    hoverOffset,\n    activeIndexAnim,\n  } = useAnimatedValues();\n\n  const hoverScreenOffset = useDerivedValue(() => {\n    return hoverOffset.value - scrollOffset.value;\n  }, []);\n\n  const isScrolledUp = useDerivedValue(() => {\n    return scrollOffset.value - SCROLL_POSITION_TOLERANCE <= 0;\n  }, []);\n\n  const isScrolledDown = useDerivedValue(() => {\n    return (\n      scrollOffset.value + containerSize.value + SCROLL_POSITION_TOLERANCE >=\n      scrollViewSize.value\n    );\n  }, []);\n\n  const distToTopEdge = useDerivedValue(() => {\n    return Math.max(0, hoverScreenOffset.value);\n  }, []);\n\n  const distToBottomEdge = useDerivedValue(() => {\n    const hoverPlusActiveCell = hoverScreenOffset.value + activeCellSize.value;\n    return Math.max(0, containerSize.value - hoverPlusActiveCell);\n  }, []);\n\n  const isAtTopEdge = useDerivedValue(() => {\n    return distToTopEdge.value <= autoscrollThreshold;\n  });\n\n  const isAtBottomEdge = useDerivedValue(() => {\n    return distToBottomEdge.value <= autoscrollThreshold;\n  }, []);\n\n  const scrollTarget = useSharedValue(0);\n  const dragIsActive = useDerivedValue(() => {\n    return activeIndexAnim.value >= 0;\n  }, []);\n\n  useAnimatedReaction(\n    () => {\n      return dragIsActive.value;\n    },\n    (cur, prev) => {\n      if (cur && !prev) {\n        scrollTarget.value = scrollOffset.value;\n      }\n    }\n  );\n\n  const shouldAutoScroll = useDerivedValue(() => {\n    const scrollTargetDiff = Math.abs(scrollTarget.value - scrollOffset.value);\n    const hasScrolledToTarget = scrollTargetDiff < SCROLL_POSITION_TOLERANCE;\n\n    const isAtEdge = isAtTopEdge.value || isAtBottomEdge.value;\n    const topDisabled = isAtTopEdge.value && isScrolledUp.value;\n    const bottomDisabled = isAtBottomEdge.value && isScrolledDown.value;\n    const isEdgeDisabled = topDisabled || bottomDisabled;\n\n    const cellIsActive = activeIndexAnim.value >= 0;\n\n    return hasScrolledToTarget && isAtEdge && !isEdgeDisabled && cellIsActive;\n  }, []);\n\n  function scrollToInternal(offset: number) {\n    if (flatlistRef && \"current\" in flatlistRef) {\n      flatlistRef.current?.scrollToOffset({ offset, animated: true });\n    }\n  }\n\n  useDerivedValue(() => {\n    if (!shouldAutoScroll.value) return;\n\n    const distFromEdge = isAtTopEdge.value\n      ? distToTopEdge.value\n      : distToBottomEdge.value;\n    const speedPct = 1 - distFromEdge / autoscrollThreshold!;\n    const offset = speedPct * autoscrollSpeed;\n    const targetOffset = isAtTopEdge.value\n      ? Math.max(0, scrollOffset.value - offset)\n      : Math.min(\n          scrollOffset.value + offset,\n          scrollViewSize.value - containerSize.value\n        );\n\n    scrollTarget.value = targetOffset;\n    // Reanimated scrollTo is crashing on android. use 'regular' scrollTo until figured out.\n    // scrollTo(scrollViewRef, targetX, targetY, true);\n    runOnJS(scrollToInternal)(targetOffset);\n  }, []);\n\n  return null;\n}\n"],"mappings":"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","ignoreList":[]}