{"version":3,"names":["React","useMemo","useState","StyleSheet","Animated","runOnJS","useAnimatedReaction","useAnimatedStyle","useAnimatedValues","useDraggableFlatListContext","useRefs","typedMemo","PlaceholderItem","renderPlaceholder","_propsRef$current","size","setSize","activeCellSize","placeholderOffset","spacerIndexAnim","horizontalAnim","scrollOffset","keyToIndexRef","propsRef","activeKey","horizontal","value","cur","prev","activeIndex","current","get","undefined","activeItem","data","animStyle","offset","opacity","overflow","transform","translateX","translateY","extraStyle","width","height","createElement","View","pointerEvents","style","absoluteFill","item","index"],"sources":["PlaceholderItem.tsx"],"sourcesContent":["import React, { useMemo, useState } from \"react\";\nimport { StyleSheet } from \"react-native\";\nimport Animated, {\n  runOnJS,\n  useAnimatedReaction,\n  useAnimatedStyle,\n} from \"react-native-reanimated\";\nimport { useAnimatedValues } from \"../context/animatedValueContext\";\nimport { useDraggableFlatListContext } from \"../context/draggableFlatListContext\";\nimport { useRefs } from \"../context/refContext\";\nimport { RenderPlaceholder } from \"../types\";\nimport { typedMemo } from \"../utils\";\n\ntype Props<T> = {\n  renderPlaceholder?: RenderPlaceholder<T>;\n};\n\nfunction PlaceholderItem<T>({ renderPlaceholder }: Props<T>) {\n  const [size, setSize] = useState(0);\n  const {\n    activeCellSize,\n    placeholderOffset,\n    spacerIndexAnim,\n    horizontalAnim,\n    scrollOffset,\n  } = useAnimatedValues();\n  const { keyToIndexRef, propsRef } = useRefs<T>();\n  const { activeKey, horizontal } = useDraggableFlatListContext();\n\n  // Size does not seem to be respected when it is an animated style\n  useAnimatedReaction(\n    () => {\n      return activeCellSize.value;\n    },\n    (cur, prev) => {\n      if (cur !== prev) {\n        runOnJS(setSize)(cur);\n      }\n    }\n  );\n\n  const activeIndex = activeKey\n    ? keyToIndexRef.current.get(activeKey)\n    : undefined;\n  const activeItem =\n    activeIndex === undefined ? null : propsRef.current?.data[activeIndex];\n\n  const animStyle = useAnimatedStyle(() => {\n    const offset = placeholderOffset.value - scrollOffset.value\n    return {\n        opacity: size >= 0 ? 1 : 0,\n        overflow: 'hidden',\n        transform: [\n          horizontalAnim.value\n            ? { translateX: offset }\n            : { translateY: offset },\n        ],\n      };\n\n  }, [spacerIndexAnim, placeholderOffset, horizontalAnim, scrollOffset, size]);\n\n  const extraStyle = useMemo(() => {\n    return horizontal ? { width: size } : { height: size };\n  }, [horizontal, size])\n\n  return (\n    <Animated.View\n      pointerEvents={activeKey ? \"auto\" : \"none\"}\n      style={[StyleSheet.absoluteFill, animStyle, extraStyle]}\n    >\n      {!activeItem || activeIndex === undefined\n        ? null\n        : renderPlaceholder?.({ item: activeItem, index: activeIndex })}\n    </Animated.View>\n  );\n}\n\nexport default typedMemo(PlaceholderItem);\n"],"mappings":"AAAA,OAAOA,KAAK,IAAIC,OAAO,EAAEC,QAAQ,QAAQ,OAAO;AAChD,SAASC,UAAU,QAAQ,cAAc;AACzC,OAAOC,QAAQ,IACbC,OAAO,EACPC,mBAAmB,EACnBC,gBAAgB,QACX,yBAAyB;AAChC,SAASC,iBAAiB,QAAQ,iCAAiC;AACnE,SAASC,2BAA2B,QAAQ,qCAAqC;AACjF,SAASC,OAAO,QAAQ,uBAAuB;AAE/C,SAASC,SAAS,QAAQ,UAAU;AAMpC,SAASC,eAAeA,CAAI;EAAEC;AAA4B,CAAC,EAAE;EAAA,IAAAC,iBAAA;EAC3D,MAAM,CAACC,IAAI,EAAEC,OAAO,CAAC,GAAGd,QAAQ,CAAC,CAAC,CAAC;EACnC,MAAM;IACJe,cAAc;IACdC,iBAAiB;IACjBC,eAAe;IACfC,cAAc;IACdC;EACF,CAAC,GAAGb,iBAAiB,CAAC,CAAC;EACvB,MAAM;IAAEc,aAAa;IAAEC;EAAS,CAAC,GAAGb,OAAO,CAAI,CAAC;EAChD,MAAM;IAAEc,SAAS;IAAEC;EAAW,CAAC,GAAGhB,2BAA2B,CAAC,CAAC;;EAE/D;EACAH,mBAAmB,CACjB,MAAM;IACJ,OAAOW,cAAc,CAACS,KAAK;EAC7B,CAAC,EACD,CAACC,GAAG,EAAEC,IAAI,KAAK;IACb,IAAID,GAAG,KAAKC,IAAI,EAAE;MAChBvB,OAAO,CAACW,OAAO,CAAC,CAACW,GAAG,CAAC;IACvB;EACF,CACF,CAAC;EAED,MAAME,WAAW,GAAGL,SAAS,GACzBF,aAAa,CAACQ,OAAO,CAACC,GAAG,CAACP,SAAS,CAAC,GACpCQ,SAAS;EACb,MAAMC,UAAU,GACdJ,WAAW,KAAKG,SAAS,GAAG,IAAI,IAAAlB,iBAAA,GAAGS,QAAQ,CAACO,OAAO,cAAAhB,iBAAA,uBAAhBA,iBAAA,CAAkBoB,IAAI,CAACL,WAAW,CAAC;EAExE,MAAMM,SAAS,GAAG5B,gBAAgB,CAAC,MAAM;IACvC,MAAM6B,MAAM,GAAGlB,iBAAiB,CAACQ,KAAK,GAAGL,YAAY,CAACK,KAAK;IAC3D,OAAO;MACHW,OAAO,EAAEtB,IAAI,IAAI,CAAC,GAAG,CAAC,GAAG,CAAC;MAC1BuB,QAAQ,EAAE,QAAQ;MAClBC,SAAS,EAAE,CACTnB,cAAc,CAACM,KAAK,GAChB;QAAEc,UAAU,EAAEJ;MAAO,CAAC,GACtB;QAAEK,UAAU,EAAEL;MAAO,CAAC;IAE9B,CAAC;EAEL,CAAC,EAAE,CAACjB,eAAe,EAAED,iBAAiB,EAAEE,cAAc,EAAEC,YAAY,EAAEN,IAAI,CAAC,CAAC;EAE5E,MAAM2B,UAAU,GAAGzC,OAAO,CAAC,MAAM;IAC/B,OAAOwB,UAAU,GAAG;MAAEkB,KAAK,EAAE5B;IAAK,CAAC,GAAG;MAAE6B,MAAM,EAAE7B;IAAK,CAAC;EACxD,CAAC,EAAE,CAACU,UAAU,EAAEV,IAAI,CAAC,CAAC;EAEtB,oBACEf,KAAA,CAAA6C,aAAA,CAACzC,QAAQ,CAAC0C,IAAI;IACZC,aAAa,EAAEvB,SAAS,GAAG,MAAM,GAAG,MAAO;IAC3CwB,KAAK,EAAE,CAAC7C,UAAU,CAAC8C,YAAY,EAAEd,SAAS,EAAEO,UAAU;EAAE,GAEvD,CAACT,UAAU,IAAIJ,WAAW,KAAKG,SAAS,GACrC,IAAI,GACJnB,iBAAiB,aAAjBA,iBAAiB,uBAAjBA,iBAAiB,CAAG;IAAEqC,IAAI,EAAEjB,UAAU;IAAEkB,KAAK,EAAEtB;EAAY,CAAC,CACnD,CAAC;AAEpB;AAEA,eAAelB,SAAS,CAACC,eAAe,CAAC","ignoreList":[]}